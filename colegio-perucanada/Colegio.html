<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intranet IA - Colegio Per√∫-Canad√°</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Iconos Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Tu CSS Personalizado -->
    <link rel="stylesheet" href="style.css"> 
</head>
<body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom sticky-top shadow-sm">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="logo1.jpg" alt="Logo" class="logo-img me-2">
                <div>
                    <div class="fw-bold lh-1">I.E. 3080</div>
                    <small style="font-size: 0.8rem;">Per√∫ - Canad√°</small>
                </div>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link active" href="#" onclick="location.reload()">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#noticias">Noticias</a></li>
                    <li class="nav-item ms-lg-3">
                        <button id="btn-acceso-directo" class="btn btn-warning fw-bold text-dark">
                            <i class="bi bi-person-lock"></i> Acceso Intranet
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 1. VISTA P√öBLICA (PORTADA) -->
    <div id="public-view">
        <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="baner.jpg" class="d-block w-100" alt="Bienvenida">
                    <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded">
                        <h5>Formaci√≥n Integral</h5>
                        <p>Bienvenidos al a√±o escolar 2025.</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="regre.jpg" class="d-block w-100" alt="Regreso a Clases">
                    <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded">
                        <h5>Regreso Seguro</h5>
                        <p>Protocolos y seguridad para nuestros alumnos.</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="baner.jpeg" class="d-block w-100" alt="Actividades">
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
            </button>
        </div>

        <section id="noticias" class="container py-5">
            <h2 class="text-center mb-4 text-primary fw-bold">Vida Escolar</h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0">
                        <img src="labo.jpg" class="card-img-top" alt="Laboratorio">
                        <div class="card-body">
                            <h5 class="card-title fw-bold">Innovaci√≥n y Ciencia</h5>
                            <p class="card-text">Nuestros laboratorios equipados para el futuro.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0">
                        <img src="feri.jpg" class="card-img-top" alt="Feria de Ciencias">
                        <div class="card-body">
                            <h5 class="card-title fw-bold">Feria de Logros</h5>
                            <p class="card-text">Demostrando el talento de nuestros estudiantes.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0">
                        <img src="refo.jpg" class="card-img-top" alt="Reforzamiento">
                        <div class="card-body">
                            <h5 class="card-title fw-bold">Reforzamiento Escolar</h5>
                            <p class="card-text">Acompa√±amiento personalizado para cada alumno.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- 2. VISTA LOGIN / REGISTRO -->
    <div id="login-view" style="display: none;" class="min-vh-100 align-items-center bg-light">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-5">
                    <div class="card shadow-lg border-0 rounded-4">
                        <div class="card-body p-5">
                            <div class="text-center mb-4">
                                <img src="logo1.jpg" alt="Logo" style="width: 80px;" class="mb-3 rounded-circle">
                                <h4 class="fw-bold text-primary">Acceso Intranet</h4>
                                <p class="text-muted small">Ingrese sus credenciales o reg√≠strese</p>
                            </div>

                            <div id="login-error" class="alert alert-danger d-none text-center small"></div>

                            <ul class="nav nav-pills nav-fill mb-4" id="pills-tab" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="tab-login" data-bs-toggle="pill" data-bs-target="#pills-login" type="button">Ingresar</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="tab-register" data-bs-toggle="pill" data-bs-target="#pills-register" type="button">Registrarse</button>
                                </li>
                            </ul>

                            <div class="tab-content" id="pills-tabContent">
                                <!-- LOGIN -->
                                <div class="tab-pane fade show active" id="pills-login">
                                    <form id="form-login">
                                        <div class="mb-3">
                                            <label class="form-label small fw-bold">Usuario</label>
                                            <input type="text" id="login-user" class="form-control" placeholder="Ej: padre_luis" required>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label small fw-bold">Contrase√±a</label>
                                            <input type="password" id="login-pass" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                                        </div>
                                        <button type="submit" class="btn btn-primary w-100 py-2 fw-bold">Iniciar Sesi√≥n</button>
                                    </form>
                                </div>

                                <!-- REGISTRO -->
                                <div class="tab-pane fade" id="pills-register">
                                    <div class="d-flex gap-2 mb-3">
                                        <button class="btn btn-outline-primary w-50 active" onclick="app.toggleRegisterForm('tutor')">Soy Padre</button>
                                        <button class="btn btn-outline-success w-50" onclick="app.toggleRegisterForm('docente')">Soy Docente</button>
                                    </div>

                                    <!-- FORMULARIO TUTOR -->
                                    <form id="form-register-tutor">
                                        <h6 class="text-primary border-bottom pb-2">Datos del Padre</h6>
                                        <div class="row g-2 mb-2">
                                            <div class="col"><input type="text" class="form-control form-control-sm" id="reg-t-nombre" placeholder="Nombre Completo" required></div>
                                            <div class="col"><input type="text" class="form-control form-control-sm" id="reg-t-dni" placeholder="DNI (8 d√≠gitos)" maxlength="8" required></div>
                                        </div>
                                        <input type="text" class="form-control form-control-sm mb-2" id="reg-t-tel" placeholder="Celular" required>
                                        
                                        <h6 class="text-primary border-bottom pb-2 mt-3">Datos del Hijo (Estudiante)</h6>
                                        <input type="text" class="form-control form-control-sm mb-2" id="reg-st-nombre" placeholder="Nombre del Alumno" required>
                                        <input type="text" class="form-control form-control-sm mb-2" id="reg-st-dni" placeholder="DNI del Alumno (8 d√≠gitos)" maxlength="8" required>
                                        
                                        <select id="reg-st-grado" class="form-select form-select-sm mb-3">
                                            <option value="1">Primero de Primaria</option>
                                            <option value="2">Segundo de Primaria</option>
                                            <option value="3">Tercero de Primaria</option>
                                        </select>

                                        <h6 class="text-primary border-bottom pb-2 mt-3">Credenciales</h6>
                                        <div class="input-group input-group-sm mb-3">
                                            <input type="text" class="form-control" id="reg-t-user" placeholder="Usuario deseado" required>
                                            <input type="password" class="form-control" id="reg-t-pass" placeholder="Clave" required>
                                        </div>
                                        <!-- BOT√ìN CORREGIDO: TYPE BUTTON + ONCLICK -->
                                        <button type="button" class="btn btn-primary btn-sm w-100 mt-3 fw-bold" onclick="app.procesarRegistroTutor()">
                                            Registrar Familia
                                        </button>
                                        <small class="text-muted d-block mt-2 text-center" style="font-size: 0.75rem;">Nota: Su cuenta requerir√° aprobaci√≥n del Administrador.</small>
                                    </form>

                                    <!-- FORMULARIO DOCENTE -->
                                    <form id="form-register-docente" style="display: none;">
                                        <h6 class="text-success border-bottom pb-2">Datos del Docente</h6>
                                        <div class="mb-2"><input type="text" class="form-control form-control-sm" id="reg-d-nombre" placeholder="Nombre Completo" required></div>
                                        <div class="row g-2 mb-2">
                                            <div class="col"><input type="text" class="form-control form-control-sm" id="reg-d-dni" placeholder="DNI" maxlength="8" required></div>
                                            <div class="col"><input type="text" class="form-control form-control-sm" id="reg-d-apellido" placeholder="Apellidos" required></div>
                                        </div>
                                        
                                        <h6 class="text-success border-bottom pb-2 mt-3">Asignaci√≥n</h6>
                                        <label class="small text-muted">¬øQu√© grado ense√±ar√° principalmente?</label>
                                        <select id="reg-d-grado" class="form-select form-select-sm mb-3">
                                            <option value="1">Primero (Polidocencia)</option>
                                            <option value="2">Segundo (Polidocencia)</option>
                                            <option value="3">Tercero (Polidocencia)</option>
                                        </select>

                                        <h6 class="text-success border-bottom pb-2 mt-3">Credenciales</h6>
                                        <div class="input-group input-group-sm mb-3">
                                            <input type="text" class="form-control" id="reg-d-user" placeholder="Usuario" required>
                                            <input type="password" class="form-control" id="reg-d-pass" placeholder="Clave" required>
                                        </div>
                                        <!-- BOT√ìN CORREGIDO: TYPE BUTTON + ONCLICK -->
                                        <button type="button" class="btn btn-success btn-sm w-100 mt-3 fw-bold" onclick="app.procesarRegistroDocente()">
                                            Registrar Docente
                                        </button>
                                    </form>
                                </div>
                            </div>
                            
                            <div class="text-center mt-3">
                                <a href="#" class="text-muted small text-decoration-none" onclick="location.reload()">‚Üê Volver al Inicio</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 3. VISTA INTRANET (PANELES) -->
    <div id="intranet-view" style="display: none;" class="min-vh-100 bg-light">
        <div class="bg-primary text-white py-3 shadow">
            <div class="container d-flex justify-content-between align-items-center">
                <h4 class="mb-0"><i class="bi bi-speedometer2"></i> Panel de Control</h4>
                <button id="btn-logout" class="btn btn-danger btn-sm">Cerrar Sesi√≥n</button>
            </div>
        </div>

        <div class="container py-4">
            <!-- Mensaje de Bienvenida Din√°mico -->
            <div class="alert alert-warning border-0 shadow-sm d-flex align-items-center" role="alert">
                <i class="bi bi-person-circle fs-3 me-3"></i>
                <div>
                    <h5 class="alert-heading mb-0" id="user-welcome">Bienvenido</h5>
                    
                    <small class="text-muted" id="perfil-rol">Perfil: Tutor / Padre de familia</small>
                </div>
            </div>

            <!-- DASHBOARD PADRES (CARDS) -->
            <div id="dashboard-cards" class="row g-4">
                <div class="col-md-4">
                    <div class="card text-center h-100 border-0 shadow-sm card-hover" id="card-notas" style="cursor: pointer;" onclick="app.mostrarVistaIntranet('notas'); app.cargarNotasEnTabla()">
                        <div class="card-body">
                            <i class="bi bi-journal-check text-primary display-4 mb-3"></i>
                            <h5 class="card-title">Ver notas</h5>
                            <p class="text-muted">Consultar libretas y promedios.</p>
                            <button class="btn btn-outline-primary btn-sm">Acceder</button>
                        </div>
                    </div>
                </div>
                <!-- CARD DE ASISTENCIA (TUTOR) -->
                <div class="col-md-4">
                    <div class="card text-center h-100 border-0 shadow-sm card-hover">
                        <div class="card-body">
                            <i class="bi bi-calendar3 text-success display-4 mb-3"></i>
                            <h5 class="card-title">Asistencia</h5>
                            <p class="text-muted">Reporte de faltas y tardanzas.</p>
                        
                            <button id="btn-asistencia" class="btn btn-outline-success btn-sm px-4">Ver Reporte</button>
                        </div>
                    </div>
                </div>
                <!-- CARD DE OBSERVACIONES -->
                <div class="col-md-4">
                    <div class="card text-center h-100 border-0 shadow-sm card-hover">
                        <div class="card-body">
                            <i class="bi bi-eye text-warning display-4 mb-3"></i>
                            <h5 class="card-title">Observaciones</h5>
                            <p class="text-muted">Reportes de conducta.</p>
                        
                            <button id="btn-observaciones" class="btn btn-outline-warning px-4">Ver Reportes</button>
                        </div>
                    </div>
                </div>
                <!-- CARD DE DATOS -->
                <div class="col-md-4">
                    <div class="card text-center h-100 border-0 shadow-sm">
                        <div class="card-body">
                            <i class="bi bi-phone text-info display-4 mb-3"></i>
                            <h5 class="card-title">Mis datos</h5>
                            <p class="text-muted small">Actualice su n√∫mero de contacto.</p>
                            <div class="input-group mb-2">
                                <span class="input-group-text"><i class="bi bi-telephone"></i></span>
                                <input type="text" id="input-nuevo-telefono" class="form-control" placeholder="Nuevo Celular">
                            </div>
                            <button id="btn-actualizar-datos" class="btn btn-outline-info btn-sm w-100">Guardar Cambios</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="asistencia-tutor-view" style="display: none;" class="mt-4">
                <button class="btn btn-secondary mb-3" onclick="document.getElementById('asistencia-tutor-view').style.display='none'; document.getElementById('dashboard-cards').style.display='flex';">
                    <i class="bi bi-arrow-left"></i> Volver al Panel
                </button>

                <div class="card shadow border-0">
                    <div class="card-header bg-success text-white fw-bold">
                        <i class="bi bi-calendar-check"></i> Reporte de Asistencia
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle" id="tabla-asistencia-tutor">
                                <thead class="table-light">
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Curso</th>
                                        <th>Estudiante</th> <th class="text-center">Estado</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DASHBOARD DOCENTE -->
            <div id="docente-dashboard-cards" style="display: none;" class="mb-4">
                
                <div class="card shadow border-0">
                    <div class="card-header bg-primary text-white py-3 d-flex justify-content-between align-items-center flex-wrap gap-2">
                        
                        <div>
                            <h4 class="mb-0 fw-bold"><i class="bi bi-chalkboard-teacher"></i> Panel Docente</h4>
                            <small class="text-white-50">Sus cursos asignados</small>
                        </div>

                        <button class="btn btn-warning text-dark fw-bold shadow-sm btn-sm px-3" onclick="app.abrirPanelObservacionesDocente()">
                            <i class="bi bi-exclamation-triangle-fill"></i> Registrar Incidente
                        </button>

                    </div>
                    
                    <div class="card-body bg-light">
                        <div class="row g-4 justify-content-center" id="contenedor-cursos-docente">
                            <div class="text-center py-5 w-100">
                                <div class="spinner-border text-primary" role="status"></div>
                                <p class="mt-2 text-muted">Buscando cursos...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VISTA DE OBSERVACIONES (Tutor) -->
            <div id="observaciones-view" style="display: none;" class="mt-4">
                <button class="btn btn-secondary mb-3" onclick="app.mostrarVistaIntranet('dashboard')">
                    <i class="bi bi-arrow-left"></i> Volver
                </button>
                
                <div class="card shadow border-0">
                    <div class="card-header bg-warning text-dark fw-bold">
                        <i class="bi bi-clipboard-data"></i> Libro de Observaciones
                    </div>
                    <div class="card-body">
                        <div class="alert alert-warning py-2 small">
                            <i class="bi bi-info-circle"></i> Aqu√≠ se muestran los reportes de conducta de sus hijos.
                        </div>
                        <div class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead><tr><th>Fecha</th><th>T√≠tulo</th><th class="text-center">Gravedad</th><th>Detalle</th></tr></thead>
                                <tbody id="tabla-observaciones">
                                    <tr><td colspan="4" class="text-center text-muted">Cargando...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VISTA DE OBSERVACIONES (Docente) -->
            <div id="docente-observaciones-view" style="display: none;" class="mt-4 container">
                <button class="btn btn-secondary mb-3 shadow-sm" onclick="app.volverADashboard()">
                    <i class="bi bi-arrow-left"></i> Volver al Panel Docente
                </button>

                <div class="card shadow border-0">
                    <div class="card-header bg-danger text-white fw-bold">
                        <i class="bi bi-exclamation-triangle"></i> Registrar Incidente
                    </div>
                    <div class="card-body">
                        <div id="form-observacion-docente" class="mb-4 p-3 bg-light rounded border">
                            <h6 class="fw-bold text-danger">Nueva Observaci√≥n</h6>
                            <div class="row g-2">
                                <div class="col-md-6">
                                    <label class="small text-muted">DNI del Estudiante:</label>
                                    <input type="text" id="obs-dni-alumno" class="form-control form-control-sm" placeholder="Ingrese DNI (8 d√≠gitos)">
                                </div>
                                <div class="col-md-6">
                                    <label class="small text-muted">Nivel de Gravedad:</label>
                                    <select id="obs-nivel" class="form-select form-select-sm">
                                        <option value="Leve">Leve (Amonestaci√≥n verbal)</option>
                                        <option value="Moderado">Moderado (Nota a los padres)</option>
                                        <option value="Grave">Grave (Suspensi√≥n/Direcci√≥n)</option>
                                    </select>
                                </div>
                                <div class="col-12">
                                    <label class="small text-muted">T√≠tulo del Incidente:</label>
                                    <input type="text" id="obs-titulo" class="form-control form-control-sm" placeholder="Ej: Pelea en el recreo, No trajo tarea...">
                                </div>
                                <div class="col-12">
                                    <label class="small text-muted">Descripci√≥n detallada:</label>
                                    <textarea id="obs-descripcion" class="form-control form-control-sm" rows="3" placeholder="Describa qu√© sucedi√≥..."></textarea>
                                </div>
                                <div class="col-12 text-end">
                                    <button class="btn btn-danger fw-bold shadow-sm" onclick="app.registrarObservacion()">
                                        <i class="bi bi-save"></i> Guardar Observaci√≥n
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VISTA DE ASISTENCIA (TUTOR) -->
            <div id="asistencia-tutor-view" style="display: none;" class="mt-4">
                <button class="btn btn-secondary mb-3" onclick="app.mostrarVistaIntranet('dashboard')"><i class="bi bi-arrow-left"></i> Volver</button>
                <div class="card shadow border-0">
                    <div class="card-header bg-success text-white fw-bold"><i class="bi bi-calendar-check"></i> Reporte de Asistencia</div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle" id="tabla-asistencia-tutor">
                                <thead class="table-light"><tr><th>Fecha</th><th class="text-center">Estado</th></tr></thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DASHBOARD ADMIN -->
            <div id="dashboard-admin" style="display: none;">
                <div class="alert alert-danger shadow-sm mb-4">
                    <h4 class="alert-heading"><i class="bi bi-shield-lock-fill"></i> Panel Administrativo</h4>
                    <p>Gesti√≥n acad√©mica integral y control de usuarios.</p>
                </div>
                
                <!-- M√©tricas -->
                <div class="row g-3 mb-4">
                    <div class="col-md-3"><div class="card text-white bg-primary h-100 shadow-sm"><div class="card-body"><h6>Estudiantes</h6><h2 id="count-estudiantes">0</h2></div></div></div>
                    <div class="col-md-3"><div class="card text-white bg-success h-100 shadow-sm"><div class="card-body"><h6>Docentes</h6><h2 id="count-docentes">0</h2></div></div></div>
                    <div class="col-md-3"><div class="card text-white bg-info h-100 shadow-sm"><div class="card-body"><h6>Tutores</h6><h2 id="count-tutores">0</h2></div></div></div>
                    <div class="col-md-3"><div class="card text-white bg-warning h-100 shadow-sm"><div class="card-body"><h6 class="text-dark">Pendientes</h6><h2 class="text-dark" id="count-pendientes">0</h2></div></div></div>
                </div>

                <!-- Botones de Acci√≥n Admin -->
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="card text-center h-100 border-0 shadow-sm bg-dark text-white card-hover" style="cursor: pointer;" onclick="app.abrirPanelAsignacion()">
                            <div class="card-body"><i class="bi bi-person-video3 display-4 mb-3"></i><h5 class="card-title">Asignar Docentes</h5></div>
                        </div>
                    </div>
                    <div class="col-md-4">
                         <div class="card text-center h-100 border-0 shadow-sm bg-secondary text-white card-hover" style="cursor: pointer;" onclick="app.mostrarListasCompletas()">
                            <div class="card-body"><i class="bi bi-list-ul display-4 mb-3"></i><h5 class="card-title">Directorios</h5></div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center h-100 border-0 shadow-sm bg-light text-dark border">
                            <div class="card-body">
                                <h5 class="card-title">Consultar Notas</h5>
                                <div class="input-group input-group-sm mt-3">
                                    <input type="text" id="admin-search-dni" class="form-control" placeholder="DNI Tutor...">
                                    <button class="btn btn-primary" onclick="app.adminBuscarNotas()"><i class="bi bi-search"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Panel Aprobaci√≥n de Usuarios -->
                <div id="panel-aprobacion" class="mt-5">
                    <div class="card shadow border-0">
                        <div class="card-header bg-warning text-dark fw-bold d-flex justify-content-between">
                            <span><i class="bi bi-check-circle-fill"></i> Solicitudes Pendientes</span>
                            <span class="badge bg-dark" id="badge-pendientes-count">0 nuevas</span>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover align-middle">
                                    <thead class="table-dark"><tr><th>Tutor</th><th>DNI</th><th>Usuario</th><th>Acci√≥n</th></tr></thead>
                                    <tbody id="tabla-pendientes"><tr><td colspan="4" class="text-center text-muted py-3">Cargando...</td></tr></tbody>
                                </table>
                            </div>
                            <button class="btn btn-sm btn-outline-dark mt-2" onclick="app.cargarPendientes ? app.cargarPendientes() : console.warn('Cargando...')">
                                <i class="bi bi-arrow-clockwise"></i> Actualizar Lista
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Modales Admin -->
                <div id="admin-asignacion-view" style="display: none;" class="mt-5">
                    <div class="card shadow border-0">
                        <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Carga Acad√©mica</h5>
                            <button class="btn btn-sm btn-outline-light" onclick="document.getElementById('admin-asignacion-view').style.display='none'"><i class="bi bi-x-lg"></i></button>
                        </div>
                        <div class="card-body bg-light">
                            <div class="row g-2 align-items-center mb-4 p-3 bg-white rounded shadow-sm">
                                <div class="col-md-5"><label class="small fw-bold">Curso:</label><select id="admin-select-curso" class="form-select"></select></div>
                                <div class="col-md-5"><label class="small fw-bold">Docente:</label><select id="admin-select-docente" class="form-select"></select></div>
                                <div class="col-md-2 text-end"><label class="d-block small">&nbsp;</label><button class="btn btn-primary w-100" onclick="app.guardarAsignacion()"><i class="bi bi-save"></i> Asignar</button></div>
                            </div>
                            <div class="table-responsive" style="max-height: 300px; overflow-y: auto;">
                                <table class="table table-sm table-hover bg-white" id="tabla-asignaciones">
                                    <thead class="table-dark sticky-top"><tr><th>Curso</th><th>Docente</th></tr></thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="admin-listas-view" style="display: none;" class="mt-5">
                    <div class="card shadow border-0">
                         <div class="card-header bg-secondary text-white d-flex justify-content-between">
                            <h5>Directorios</h5>
                            <button class="btn btn-sm btn-light" onclick="document.getElementById('admin-listas-view').style.display='none'">Cerrar</button>
                         </div>
                         <div class="card-body">
                             <ul class="nav nav-tabs" id="myTab" role="tablist">
                                <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-alumnos" type="button">Alumnos</button></li>
                                <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-tutores" type="button">Tutores</button></li>
                             </ul>
                             <div class="tab-content p-3 border border-top-0 rounded-bottom">
                                 <div class="tab-pane fade show active" id="tab-alumnos">
                                     <table class="table table-sm table-hover" id="tab-alumnos"><thead><tr><th>Nombre</th><th>Grado</th><th>Tutor</th></tr></thead><tbody></tbody></table>
                                 </div>
                                 <div class="tab-pane fade" id="tab-tutores">
                                     <table class="table table-sm table-hover" id="tab-tutores"><thead><tr><th>Nombre</th><th>DNI</th><th>Tel√©fono</th></tr></thead><tbody></tbody></table>
                                 </div>
                             </div>
                         </div>
                    </div>
                </div>
            </div>

            <!-- GESTION NOTAS DOCENTE -->
            <div id="docente-gestion-notas" style="display: none;" class="mt-4 container">
                
                <button class="btn btn-secondary mb-3 shadow-sm" onclick="app.volverADashboard()">
                    <i class="bi bi-arrow-left"></i> Volver al Panel Docente
                </button> 
                
                <div class="card shadow border-0">
                    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                        <h5 class="mb-0" id="titulo-curso-gestion">Gesti√≥n de Notas - <span id="nombre-curso"></span></h5>
                        <select id="select-bimestre" class="form-select form-select-sm" style="width: 150px;" onchange="app.cargarNotasPorBimestre(this.value)">
                            <option value="1">1¬∞ Bimestre</option>
                            <option value="2">2¬∞ Bimestre</option>
                            <option value="3">3¬∞ Bimestre</option>
                            <option value="4">4¬∞ Bimestre</option>
                        </select>
                    </div>
                    
                    <div class="card-body">
                        <p class="text-muted small">Ingrese las notas de 00 a 20. Los cambios no se guardar√°n hasta que use el bot√≥n azul.</p>
                        <div class="table-responsive">
                            <table class="table table-hover align-middle" id="tabla-gestion-notas">
                                <thead class="table-light">
                                    <tr>
                                        <th>Estudiante</th>
                                        <th class="text-center" style="width: 150px;">Nota (00-20)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    </tbody>
                            </table>
                        </div>
                    </div>
                    
                    </div>
            </div>

            <!-- TOMA DE ASISTENCIA DOCENTE -->

            <div id="docente-asistencia-view" style="display: none;" class="mt-4 container">
                
                <button class="btn btn-secondary mb-3 shadow-sm" onclick="app.volverADashboard()">
                    <i class="bi bi-arrow-left"></i> Volver al Panel Docente
                </button>

                <div class="card shadow border-0">
                    <div class="card-header bg-success text-white py-3">
                        <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
                            <div>
                                <h5 class="mb-0 fw-bold" id="titulo-curso-asistencia">Control de Asistencia</h5>
                                <small class="text-white-50">Seleccione la fecha y marque el estado</small>
                            </div>
                            
                            <div class="bg-white p-1 rounded text-dark d-flex align-items-center">
                                <span class="fw-bold me-2 small px-2">FECHA:</span>
                                <input type="date" id="input-fecha-asistencia" class="form-control form-control-sm fw-bold border-0" 
                                       onchange="app.cargarAsistenciaPorFecha(this.value)">
                            </div>
                        </div>
                    </div>

                    <div class="card-body">
                        <div class="d-flex gap-2 mb-3 justify-content-end bg-light p-2 rounded border">
                            <span class="small text-muted align-self-center me-auto">Marcar todo r√°pido:</span>
                            <button class="btn btn-outline-success btn-sm fw-bold" onclick="app.marcarAsistenciaMasiva('Presente')">Todos P</button>
                            <button class="btn btn-outline-warning btn-sm fw-bold" onclick="app.marcarAsistenciaMasiva('Tardanza')">Todos T</button>
                            <button class="btn btn-outline-danger btn-sm fw-bold" onclick="app.marcarAsistenciaMasiva('Falta')">Todos F</button>
                        </div>

                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0" id="tabla-asistencia-docente">
                                <thead class="table-light">
                                    <tr>
                                        <th>Estudiante</th>
                                        <th style="width: 180px;" class="text-center">Estado</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DETALLE NOTAS (TUTOR) -->
            <div id="notas-detalle" style="display: none;" class="mt-4">
                <!-- AQU√ç EST√Å LA CORRECCI√ìN DEL BOT√ìN VOLVER -->
                <button class="btn btn-secondary mb-3" onclick="app.volverADashboard()"><i class="bi bi-arrow-left"></i> Volver</button>
                
                <div class="card border-0 shadow">
                    <div class="card-header bg-white fw-bold"><i class="bi bi-table"></i> R√©cord acad√©mico 2025</div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle" id="tabla-notas">
                                <thead class="table-light"><tr><th>Curso</th><th>Bimestre</th><th class="text-center">Nota</th><th class="text-center">Estado</th></tr></thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CHATBOT -->
    <div class="chatbot-container">
        <div id="chatbot-window" style="display: none;" class="shadow-lg">
            <div class="bg-primary text-white p-2 d-flex flex-column">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="fw-bold"><i class="bi bi-robot"></i> Asistente IA</span>
                    <button id="btn-close-chat" class="btn-close btn-close-white small"></button>
                </div>
                <div class="btn-group w-100" role="group">
                    <input type="radio" class="btn-check" name="ai-mode" id="mode-school" autocomplete="off" checked>
                    <label class="btn btn-outline-light btn-sm" for="mode-school">üè´ Colegio</label>
                    <input type="radio" class="btn-check" name="ai-mode" id="mode-free" autocomplete="off">
                    <label class="btn btn-outline-light btn-sm" for="mode-free">üåç Libre</label>
                </div>
            </div>
            <div id="chatbot-body" class="bg-light">
                <div class="text-center text-muted small mt-3">Hola, soy tu asistente virtual.<br><span>Modo Colegio Activo.</span></div>
            </div>
            <div class="p-2 border-top bg-white d-flex">
                <input type="text" id="chatbot-input" class="form-control me-2" placeholder="Escribe aqu√≠...">
                <button id="chatbot-send" class="btn btn-primary"><i class="bi bi-send-fill"></i></button>
            </div>
        </div>
        <button id="chatbot-button"><i class="bi bi-chat-dots-fill text-white fs-3"></i></button>
    </div>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="js/main.js"></script>

</body>
</html>